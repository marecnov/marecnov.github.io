let modal=document.getElementById("modal-overlay"),link=document.getElementById("settingsLink"),closeBtn=document.querySelector("#modal .close"),applyBtn=document.querySelector("#modal button"),inputs=[document.querySelector("#modal select"),document.querySelector("#modal input")];link.addEventListener("click",(()=>{modal.style.display="block",updateModal(currentSettings)})),closeBtn.onclick=function(){modal.style.display="none"},document.addEventListener("click",(e=>{e.target===modal&&(modal.style.display="none")})),document.addEventListener("keydown",(e=>{"block"===modal.style.display&&"Escape"===e.key&&(modal.style.display="none")})),applyBtn.addEventListener("click",(()=>{let e={darkMode:inputs[1].checked?"dark":"light",lang:inputs[0].value};localStorage.setItem("SETTINGS",JSON.stringify(e)),currentSettings=e,applyStngs(e),modal.style.display="none"}));const defaultSettings={darkMode:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",lang:window.location.pathname.startsWith("/ru")?"ru":"en"};function updateModal(e){inputs[0].value=e.lang,inputs[1].checked="dark"===e.darkMode}function getSettings(){const e=localStorage.getItem("SETTINGS");return e?{...defaultSettings,...JSON.parse(e)}:defaultSettings}function applyTheme(e){document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(e)}function handleLanguageRedirect(e){if(e!==(window.location.pathname.startsWith("/ru")?"ru":"en")){const t="ru"===e?`/ru${window.location.pathname.replace(/^\/ru/,"")}${window.location.hash}`:window.location.pathname.replace(/^\/ru/,"")+window.location.hash;window.location.replace(window.location.origin+t)}}function applyStngs(e){applyTheme(e.darkMode),handleLanguageRedirect(e.lang)}let currentSettings=getSettings();applyStngs(currentSettings);
